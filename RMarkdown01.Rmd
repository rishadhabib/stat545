---
title: "RMarkdown01"
output:
  github_document: default
  html_document:
    keep_md: yes
---

- use markdown files for Github
- ctrl + alt + i to insert a code chunk
- put a comma after r to set how the run will load


```{r, fig.height=5, fig.width = 4}
x <- rnorm(500)
y <- rnorm(500) 

plot (x, y)
```

```{r}

```



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
#plot run

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


##cm005

```{r}
library(gapminder)
library (tidyverse)
```

```{r}
##How many variables (columns) are in the iris dataset, and what are their names?
str(iris)
```

```{r}
#How many rows are in the data set?
nrow(iris)

```

```{r}
#What are the smallest values of each numeric variable?
summary(iris)
```

```{r}
#Extract the Petal.Width column to get a vector of observations (we’ll see vectors in more detail in a later class), and
petalwidth <- iris$Petal.Width
#Make a histogram
hist(petalwidth)
#Make a table of frequencies
table(iris$Petal.Width, iris$Species)
```

2.2. dplyr fundamentals

```{r}
filter(gapminder, country=="Canada" & year >1970) #use the filter to choose your data
```


```{r}
#Find all entries of Canada and Algeria.
filter(gapminder, country %in% c("Canada", "Algeria"))

#Find all entries of Canada and Algeria, occuring in the ’60s.
filter(gapminder, country %in% c("Canada", "Algeria"), year >=1960 & year < 1970)

#Find all entries of Canada, and entries of Algeria occuring in the ’60s.
filter(gapminder, (country =="Canada")| (country == "Algeria"& year >=1960 & year < 1970))
#also: filter(gapminder, (country =="Canada")| (country == "Algeria"& year %in% 1960:1969)) 

#Find all entries not including European countries.
filter(gapminder, continent != "Europe")

```

select subsets data by columns/variable names.
```{r}
select(gapminder, continent, country) #you can use - to remove columns
```

The pipe operator %>% feeds the output of a function into another function
```{r}
gapminder %>%  #The pipe operator %>% feeds the output of a function into another function
  filter(country %in% c("Canada", "Algeria"), 
         year <= 1969, year >= 1960) %>% 
  select(country, year, gdpPercap) 
```


```{r}
#Exercise: Take all countries in Europe that have a GPD per capita greater than 10000, and select all variables except gdpPercap. (Hint: use -).
gapminder %>%
  filter(continent == "Europe" & gdpPercap > 10000) %>%
  select (-gdpPercap)
```


arrange sorts a data frame by shuffling the order of the rows appropriately. Use desc to sort by descending order.
```{r}
arrange(gapminder, desc(pop), desc(lifeExp))
```
Exercises:

```{r}
#Order the data frame by year, then descending by life expectancy.
arrange(gapminder, year, desc(lifeExp))

#In addition to the above exercise, rearrange the variables so that year comes first, followed by life expectancy. (Hint: check the documentation for the select function for a related handy function).
gapminder %>%
  arrange(year, desc(lifeExp)) %>% 
  select (year, lifeExp, everything())
  
```


## Date: 21st September 2017

mutate creates a new variable by calculating from other variables. 
- transmute works the same way, but drops all other variables.
```{r}
mutate(gapminder, 
       gdp = gdpPercap * pop,
       gdpBill = round(gdp/10000000, 1))
```

```{r}
#Exercise: Make a new column called cc that pastes the country name followed by the continent, separated by a comma. (Hint: use the paste function with the sep=", " argument).

mutate(gapminder, country_cont = paste(country, continent, sep = ", "))
```

summarize reduces a tibble according to summary statistics.
```{r}
summarize(gapminder, mean_pop=mean(pop), sd_pop=sd(pop))
```

```{r}
gapminder %>% 
    group_by(continent) %>% 
    summarize(mean_pop=mean(pop), sd_pop=sd(pop))
```
```{r}
group_by(gapminder, year<1970)
```
```{r}
(out1 <- gapminder %>% 
    group_by(continent, year < 1970) %>% 
    summarize(mean_pop=mean(pop), sd_pop=sd(pop)))
 
```
```{r}
#Exercise: Find the minimum GDP per capita experienced by each country
(out2 <- gapminder %>% 
    group_by(country) %>% 
    summarize(min.gdp=min(gdpPercap)))


#Exercise: How many years of record does each country have?
(out3 <- gapminder %>% 
    group_by(country) %>% 
    summarize(nyear = n_distinct(year)))

#Exercise: Within Asia, what are the min and max life expectancies experienced in each year?
gapminder%>%
  filter(continent == "Asia") %>%
  group_by(year) %>%
    summarize (miexp = min(lifeExp), (maxexp = max(lifeExp)))

```


## cm006

Using ggplot

```{r}
p <- ggplot(gapminder, aes(x=year, y=lifeExp))
p + geom_point(alpha = .25)
```

```{r}
#Exercises:

#Make a scatterplot of gdpPercap vs lifeExp. Store it in a variable called p2.
p2 <- ggplot(gapminder, aes(x = gdpPercap, y = lifeExp))
p2 + geom_point()

#To p2, make the size of the points indicate the year, choose a level of alpha transparency that you’re happy with, and make the points your favourite colour.
p2 + geom_point(aes(size =year), alpha = .15, colour = "blue")

#To p2, colour the points by continent. but this time with year being represented by the size of the points.
p2 + geom_point(aes(size=year, colour = continent), alpha = .15)

#To p2, add another layer called scale_x_log10(). Make a second plot by redoing the plot in (1), but replacing gdpPercap with log10(gdpPercap). What do you notice?
#p3 <- ggplot(gapminder, aes(x = log10(gdpPercap), y = lifeExp))
ggplot(gapminder, aes(x = log10(gdpPercap), y = lifeExp)) + geom_point(aes(colour= continent)) + scale_x_log10()
```













